<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>D3 Scatter</title>

<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">

<style>
body{
  background:#e6ded9;
  font-family:"Space Mono",monospace;
  display:flex;
  justify-content:center;
  margin-top:40px;
}

svg{
  width:600px;
  height:490px;
}

.axis text{font-size:11px;fill:#2b2b2b}
.axis path,.axis line{stroke:#b8aea8}
.grid line{stroke:#d6ccc6;stroke-dasharray:2 2}
</style>
</head>

<body>

<svg></svg>

<script src="https://d3js.org/d3.v7.min.js"></script>

<script>

const width = 600;
const height = 490;

const margin = {top:60,right:40,bottom:60,left:70};
const innerW = width-margin.left-margin.right;
const innerH = height-margin.top-margin.bottom;

const colors = {
 severe:"#d65c7a",
 risk:"#d89b3c",
 low:"#4fa7b5"
};

const svg = d3.select("svg");
const g = svg.append("g")
  .attr("transform",`translate(${margin.left},${margin.top})`);

d3.csv("data.csv").then(data=>{

 data.forEach(d=>{
   d.daily_msv = +d.daily_msv;
   d.cumulative_msv = +d.cumulative_msv;
 });

 const x = d3.scaleLog()
   .domain([1, d3.max(data,d=>d.cumulative_msv)])
   .range([0,innerW]);

 const y = d3.scaleLog()
   .domain([0.01, d3.max(data,d=>d.daily_msv)])
   .range([innerH,0]);

 // grid
 g.append("g")
  .attr("class","grid")
  .attr("transform",`translate(0,${innerH})`)
  .call(d3.axisBottom(x).ticks(6).tickSize(-innerH).tickFormat(""));

 g.append("g")
  .attr("class","grid")
  .call(d3.axisLeft(y).ticks(6).tickSize(-innerW).tickFormat(""));

 // axes
 g.append("g")
  .attr("class","axis")
  .attr("transform",`translate(0,${innerH})`)
  .call(d3.axisBottom(x).ticks(6,"~s"));

 g.append("g")
  .attr("class","axis")
  .call(d3.axisLeft(y).ticks(6,"~s"));

 const diamond = d3.symbol()
   .type(d3.symbolDiamond)
   .size(120);

 g.selectAll(".pt")
  .data(data)
  .enter()
  .append("path")
  .attr("d",diamond)
  .attr("transform",d=>`translate(${x(d.cumulative_msv)},${y(d.daily_msv)})`)
  .attr("fill",d=>colors[d.category])
  .attr("stroke","#3b2f2a");

});

</script>
</body>
</html>
